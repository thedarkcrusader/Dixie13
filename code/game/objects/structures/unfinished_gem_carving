/obj/structure/unfinished_gem_carving
	name = "bugged item"
	icon_state = "raw"
	desc = "report to coders"
	density = FALSE
	max_integrity = 100
	var/datum/gem_material/material_datum
	var/completion_percentage = 100
	var/next_side_to_hit
	var/list/skill_hits = list()

/obj/structure/unfinished_gem_carving/Initialize(mapload, /datum/gem_material/passed_material_datum)
	. = ..()
	if(isnull(passed_material_datum))
		stack_trace("a carving initialized without a material datum")
		return INITIALIZE_HINT_QDEL

	completion_percentage = 0
	material_datum = passed_material_datum
	name = "unfinished [material_datum::material_name] carving"
	desc = "an unfinished carving, this one is made of [material_datum::material_name]!"
	icon = material_datum::icon_path

/obj/structure/unfinished_gem_carving/proc/attackby(obj/item/I, mob/user, params)
    . = ..()
    attackby(obj/item/I, mob/living/user, params)
	. = ..()
	if(!istype(I, /obj/item/weapon/knife))
		return
	process_hit(I, user)

/obj/structure/unfinished_gem_carving/proc/process_hit(obj/item/weapon/knife/carving_item, mob/living/user)
	var/end_result = 0
	var/skill_level = user.get_skill_level(/datum/skill/craft/crafting)
	skill_hits += skill_level
	var/randomness = max(-10, rand((user.STALUC - 10), (user.STALUC + 2) * 2) - 10)
	if(randomness <= 0 && skill_level)
		randomness /= skill_level
	else
		randomness *= skill_level
	end_result = skill_level * 10 += randomness
